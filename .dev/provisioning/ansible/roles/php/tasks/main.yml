---

- name: Install php, apache and common extensions
  apt:
    name:
      - php
      - php-xdebug
      - php-curl
      - php-xml
      - php-soap
      - php-bcmath
      - php-mbstring
      - php-apcu
      - php-memcached
      - php-mysqli
    state: present

- name: Check if composer is installed
  command: composer
  register: composer_result

- name: Install composer
  shell: |
    curl -sS https://getcomposer.org/installer -o composer-setup.php \
    && php composer-setup.php --install-dir=/usr/local/bin --filename=composer \
    && rm composer-setup.php
  when: composer_result.stdout.find('not found') != -1

